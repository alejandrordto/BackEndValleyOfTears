window.__require=function t(o,n,e){function i(s,r){if(!n[s]){if(!o[s]){var a=s.split("/");if(a=a[a.length-1],!o[a]){var l="function"==typeof __require&&__require;if(!r&&l)return l(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+s+"'")}}var u=n[s]={exports:{}};o[s][0].call(u.exports,function(t){return i(o[s][1][t]||t)},u,u.exports,t,o,n,e)}return n[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<e.length;s++)i(e[s]);return i}({Bullet:[function(t,o,n){"use strict";cc._RF.push(o,"6dc4akQnvVCdIeaTtY356Tf","Bullet"),cc.Class({extends:cc.Component,properties:{speed:3e3,posX:0,posY:0,direccion:"up"},onCollisionEnter:function(t,o){this.node.destroy()},update:function(t){"down"==this.direccion?(this.node.x+=this.speed*t*Math.cos(90*Math.PI/180),this.node.y+=this.speed*t*Math.sin(270*Math.PI/180)):"up"==this.direccion?(this.node.x+=this.speed*t*Math.cos(270*Math.PI/180),this.node.y+=this.speed*t*Math.sin(90*Math.PI/180)):"left"==this.direccion?(this.node.x+=this.speed*t*Math.cos(180*Math.PI/180),this.node.y+=this.speed*t*Math.sin(0*Math.PI/180)):(this.node.x+=this.speed*t*Math.cos(0*Math.PI/180),this.node.y+=this.speed*t*Math.sin(180*Math.PI/180))}}),cc._RF.pop()},{}],Game:[function(t,o,n){"use strict";cc._RF.push(o,"049cfLKFsxIILQuMd04B47J","Game"),cc.Class({extends:cc.Component,properties:{tank:{default:null,type:cc.Node},channel:null},connectAndSubscribe:function(){console.info("Connecting to WS...");var t=new SockJS("/stompendpoint"),o=Stomp.over(t);o.connect({},function(){self.channel=1,console.log("Connected: "+self.channel),o.subscribe("/topic/newtank."+channel,function(t){JSON.parse(t.body)})}),console.log("Connected: ")},onLoad:function(){this.stompClient=null,this.connectAndSubscribe()}}),cc._RF.pop()},{}],Menu:[function(t,o,n){"use strict";var e;cc._RF.push(o,"86d9c6a06BPCobkgcwgeRLT","Menu");var i=t("./aaaaa"),c=t("./Rest");function s(t,o,n){return o in t?Object.defineProperty(t,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[o]=n,t}cc.Class({extends:cc.Component,properties:(e={username:null,inputName:{default:null,type:cc.EditBox},inputRoom:{default:null,type:cc.EditBox},sendButton:{default:null,type:cc.Node}},s(e,"username",null),s(e,"room",null),s(e,"id",null),s(e,"xPos",null),s(e,"yPos",null),s(e,"stompClient",null),s(e,"player",{default:null,type:cc.Node}),e),onLoad:function(){cc.game.addPersistRootNode(this.node),this.id=Math.floor(1e7*Math.random()),this.xPos=Math.floor(1e3*Math.random()),this.yPos=Math.floor(600*Math.random())},start:function(){},EditBoxDidEndEditing:function(t){this.username=this.inputName.string},beginOrWait:function(){var t=this,o={onSuccess:function(o){4==o.data.length?t.stompClient.send("/app/start/"+t.room,{},null):cc.director.loadScene("sala",function(){t.node.active=!1})},onFailed:function(t){console.log(t)}};(0,c.getRoomPlayers)(t.room,o)},loadScene:function(){var t=this,o={onSuccess:function(){t.beginOrWait()},onFailed:function(o){alert("Room "+t.room+" game has already started ")}};(0,c.joinRoom)(t.id,t.xPos,t.yPos,t.room,o)},joinThisRoom:function(){var t=this,o={onSuccess:function(){t.loadScene()},onFailed:function(t){console.log(t)}};(0,c.createRoom)(t.room,o)},createOrJoin:function(){var t=this,o={onSuccess:function(o){t.loadScene()},onFailed:function(o){t.joinThisRoom()}};(0,c.getRoomPlayers)(t.room,o)},buttonClicked:function(){var t=this;null==t.username||""==t.username?alert("Please enter a username"):null==t.room||""==t.room?alert("Please enter a room number"):(0,i.getStompClient)().then(function(o){t.stompClient=o,(0,i.subscribeTopic)(t.stompClient,"/topic/room-start-"+t.room,function(o){cc.director.loadScene("game",function(){t.node.active=!1})}),t.createOrJoin()})},setRoom:function(t,o){this.room=o}});cc._RF.pop()},{"./Rest":"Rest","./aaaaa":"aaaaa"}],Restcontroller:[function(t,o,n){"use strict";cc._RF.push(o,"2aa4ezHCtpHrI9Au/WWzDQK","Restcontroller"),Object.defineProperty(n,"__esModule",{value:!0}),n.getRoomPlayers=function(t,o){axios.get("/rooms/"+t+"/players").then(function(t){o.onSuccess(t)}).catch(function(t){o.onFailed(t)})},n.joinRoom=function(t,o,n,e,i,c){axios.put("/rooms/"+i+"/players",{id:t,x:o,y:n,pos:e}).then(function(){c.onSuccess()}).catch(function(t){c.onFailed(t)})},n.createRoom=function(t,o){axios.post("/rooms",{id:t}).then(function(){o.onSuccess()}).catch(function(t){o.onFailed(t)})},n.deleteRoom=function(t,o){axios.delete("/rooms/"+t).then(function(){o.onSuccess()}).catch(function(t){o.onFailed(t)})},cc._RF.pop()},{}],Rest:[function(t,o,n){"use strict";cc._RF.push(o,"d12b5/ARFhLhYYpjru87YS4","Rest"),Object.defineProperty(n,"__esModule",{value:!0}),n.getRoomPlayers=function(t,o){axios.get("/rooms/"+t+"/players").then(function(t){o.onSuccess(t)}).catch(function(t){o.onFailed(t)})},n.joinRoom=function(t,o,n,e,i){axios.put("/rooms/"+e+"/players",{id:t,x:o,y:n}).then(function(){i.onSuccess()}).catch(function(t){i.onFailed(t)})},n.createRoom=function(t,o){axios.post("/rooms",{id:t}).then(function(){o.onSuccess()}).catch(function(t){o.onFailed(t)})},n.deleteRoom=function(t,o){axios.delete("/rooms/"+t).then(function(){o.onSuccess()}).catch(function(t){o.onFailed(t)})},cc._RF.pop()},{}],Room:[function(t,o,n){"use strict";cc._RF.push(o,"bf22aqrH/hFi6iG1Go0J7Nu","Room");var e=t("./aaaaa.js"),i=t("./Rest.js");cc.Class({extends:cc.Component,properties:{item:{default:null,type:cc.Node},label:{default:null,type:cc.Label},content:{default:null,type:cc.Node}},onLoad:function(){this.stompClient=null,this.connectAndSubscribe()},start:function(){this.posY=-51,this.roomNumber=null;var t=this;axios.get("/rooms").then(function(o){var n;for(t.roomNumber=o.data,n=0;n<t.roomNumber;n++)t.showRoomItem(n+1)})},buttonClicked:function(){this.roomNumber<7?this.createRoomItem():alert("Maximun room capacity.")},createRoomItem:function(){var t=this,o={onSuccess:function(){console.log("ROOMMMMMMM--"+(t.roomNumber+1)+"--CREATED SUCCESFULLY"),t.stompClient.send("/topic/menu-newroom",{},JSON.stringify({}))},onFailed:function(o){alert("An error has ocurred creating the room "+(t.roomNumber+1)),console.log(o)}};(0,i.createRoom)(this.roomNumber+1,o)},showRoomItem:function(t){var o=cc.instantiate(this.item);o.y+=this.posY,o.getComponent(cc.Label).string="Room #"+t,o.getChildByName("New Button").getComponent(cc.Button).clickEvents[0].customEventData=t,this.content.addChild(o),this.posY-=51},connectAndSubscribe:function(){var t=this;(0,e.getStompClient)().then(function(o){t.stompClient=o,(0,e.subscribeTopic)(t.stompClient,"/topic/menu-newroom",function(o){t.roomNumber+=1,t.showRoomItem(t.roomNumber)})})}}),cc._RF.pop()},{"./Rest.js":"Rest","./aaaaa.js":"aaaaa"}],Stomphandler:[function(t,o,n){"use strict";cc._RF.push(o,"157f4RWZXJL/rU7UUN+m6oT","Stomphandler"),Object.defineProperty(n,"__esModule",{value:!0}),n.getStompClient=function(){return new Promise(function(t){var o=new SockJS("/stompendpoint"),n=Stomp.over(o);n.connect("yqbofqdf","6CMzc5eiNjOdlv9cP9HpqFmHLK3KxUNS",function(o){t(n)},function(t){console.info("error: "+t)},"yqbofqdf")})},n.subscribeTopic=function(t,o,n){e.push(t.subscribe(o,n))},n.getStompClientsSize=function(){return console.log(e),e.length},n.unsubscribeTopic=function(){};var e=[];cc._RF.pop()},{}],Stomphand:[function(t,o,n){"use strict";cc._RF.push(o,"92a4eHj3ExB3Yb+kVOTQ4+q","Stomphand"),Object.defineProperty(n,"__esModule",{value:!0}),n.getStompClient=function(){return new Promise(function(t){var o=new SockJS("/stompendpoint"),n=Stomp.over(o);n.connect("yqbofqdf","6CMzc5eiNjOdlv9cP9HpqFmHLK3KxUNS",function(o){t(n)},function(t){console.info("error: "+t)},"yqbofqdf")})},n.subscribeTopic=function(t,o,n){e.push(t.subscribe(o,n))},n.getStompClientsSize=function(){return console.log(e),e.length},n.unsubscribeTopic=function(){};var e=[];cc._RF.pop()},{}],Walls:[function(t,o,n){"use strict";cc._RF.push(o,"68129qznU5I+bpPsoU4OySA","Walls");var e=t("./aaaaa");cc.Class({extends:cc.Component,properties:{life:0,id:0,stompClient:null},onLoad:function(){this.room=cc.find("form").getComponent("Menu").room,this.connectAndSubscribe()},onCollisionEnter:function(t,o){"bullet"==t.node.name&&-1!=this.life&&(this.life-=1)},onCollisionExit:function(t){},golpe:function(){0==this.life&&(this.stompClient.send("/app/wall/"+this.room,{},JSON.stringify({id:this.id})),this.node.destroy())},connectAndSubscribe:function(){var t=this;(0,e.getStompClient)().then(function(o){t.stompClient=o,(0,e.subscribeTopic)(t.stompClient,"/topic/walls-"+t.room,function(o){JSON.parse(o.body).id==t.id&&t.node.destroy()})})},start:function(){},update:function(t){this.golpe()}}),cc._RF.pop()},{"./aaaaa":"aaaaa"}],aaaaa:[function(t,o,n){"use strict";cc._RF.push(o,"05e60rJyDFEk6BPkM/JK1U/","aaaaa"),Object.defineProperty(n,"__esModule",{value:!0}),n.getStompClient=function(){return new Promise(function(t){var o=new SockJS("/stompendpoint"),n=Stomp.over(o);n.connect({},function(o){t(n)},function(t){console.info("error: "+t)})})},n.subscribeTopic=function(t,o,n){e.push(t.subscribe(o,n))},n.getStompClientsSize=function(){return console.log(e),e.length},n.unsubscribeTopic=function(){};var e=[];cc._RF.pop()},{}],pO:[function(t,o,n){"use strict";cc._RF.push(o,"bdded87CDRBx5CxG9lDLONB","pO"),cc.Class({extends:cc.Component,properties:{id:null,directionx:0,directiony:0},moveTank:function(t){switch(t){case"a":this.direction="left";break;case"left":this.directionx-50>-451&&!this.collisionleft&&(this.directionx-=50,this.direction="left",this.node.runAction(cc.moveBy(.4,-50,0)));break;case"d":this.direction="right";break;case"right":this.directionx+50<451&&!this.collisionrigh&&(this.directionx+=50,this.direction="right",this.node.runAction(cc.moveBy(.4,50,0)));break;case"w":this.direction="up";break;case cc.macro.KEY.up:this.directiony+50<301&&!this.collisionup&&(this.directiony+=50,this.direction="up",this.node.runAction(cc.moveBy(.4,0,50)));break;case"s":this.direction="down";break;case"down":this.directiony-50>-301&&!this.collisiondown&&(this.directiony-=50,this.rota="down",this.node.runAction(cc.moveBy(.4,0,-50)))}}}),cc._RF.pop()},{}],tank:[function(t,o,n){"use strict";cc._RF.push(o,"4420dBIaPxE6rlCexOCy3f1","tank");var e=t("./aaaaa"),i=t("./Rest.js");cc.Class({extends:cc.Component,properties:{pos:null,id:null,stompClient:null,directionx:0,directiony:0,direction:"up",colicion:!1,collisionleft:!1,collisionrigh:!1,collisionup:!1,collisiondown:!1,bullet:{default:null,type:cc.Node},loadedPlayers:{default:[],type:[cc.Node]},player:{default:null,type:cc.Node},enem:{default:null,type:cc.Node}},setRotate:function(t){var o;return"up"==this.direction?"left"==t?(o=cc.rotateBy(0,90),this.rotationx=180,this.rotationy=0):"down"==t?(o=cc.rotateBy(0,180),this.rotationx=-90,this.rotationy=0):(o=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270):"down"==this.direction?"right"==t?(o=cc.rotateBy(0,90),this.rotationx=0,this.rotationy=0):"up"==t?(o=cc.rotateBy(0,180),this.rotationx=0,this.rotationy=-90):(o=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270):"left"==this.direction?"down"==t?(o=cc.rotateBy(0,90),this.rotationx=0,this.rotationy=90):"right"==t?(o=cc.rotateBy(0,180),this.rotationx=0,this.rotationy=180):(o=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270):"up"==t?(o=cc.rotateBy(0,90),this.rotationx=0,this.rotationy=90):"left"==t?(o=cc.rotateBy(0,180),this.rotationx=0,this.rotationy=180):(o=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270),o},onKeyEvent:function(t){var o=this.direction,n=!0;switch(t.keyCode){case cc.macro.KEY.a:this.direction="a",this.movimientoEnemy("left");break;case cc.macro.KEY.left:this.directionx-50>-451&&!this.collisionleft&&(this.directionx-=50,this.direction="left",this.node.runAction(cc.moveBy(.4,-50,0)),this.movimientoEnemy("left"));break;case cc.macro.KEY.d:this.direction="right",this.movimientoEnemy("d");break;case cc.macro.KEY.right:this.directionx+50<451&&!this.collisionrigh&&(this.directionx+=50,this.direction="right",this.node.runAction(cc.moveBy(.4,50,0)),this.movimientoEnemy("right"));break;case cc.macro.KEY.w:this.direction="up",this.movimientoEnemy("w");break;case cc.macro.KEY.up:this.directiony+50<301&&!this.collisionup&&(this.directiony+=50,this.direction="up",this.node.runAction(cc.moveBy(.4,0,50)),this.movimientoEnemy("up"));break;case cc.macro.KEY.s:this.direction="down",this.movimientoEnemy("s");break;case cc.macro.KEY.down:this.directiony-50>-301&&!this.collisiondown&&(this.directiony-=50,this.rota="down",this.node.runAction(cc.moveBy(.4,0,-50)),this.movimientoEnemy("down"));break;case cc.macro.KEY.space:var e=cc.instantiate(this.bullet);e.getComponent("Bullet").direccion=this.direction,e.x=this.node.position.x,e.y=this.node.position.y,cc.find("Canvas").addChild(e),e.active=!0;break;default:n=!1}o!=this.direction&&n&&(this.Dir=this.setRotate(o),this.node.runAction(this.setRotate(o)))},movimientoEnemy:function(t){this.stompClient.send("/app/movement/"+this.room,{},JSON.stringify({id:this.id,tecla:t}))},onLoad:function(){this.room=cc.find("form").getComponent("Menu").room,this.username=cc.find("form").getComponent("Menu").username,this.id=cc.find("form").getComponent("Menu").id,this.players=null,this.connectAndSubscribe(),cc.audioEngine.stopAll(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyEvent,this),cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1,this.rotationx=0,this.rotationy=90,this.loadAllPlayers()},onEnable:function(){cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1},onDisable:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getCollisionManager().enabledDebugDraw=!1},onCollisionEnter:function(t,o){var n=t.world.aabb,e=(t.world.preAabb.clone(),o.world.aabb);o.world.preAabb.clone();e.center.x-n.center.x<0&&Math.abs(e.center.y-n.center.y)<50&&(this.collisionrigh=!0,t.touchingX=!1,t.touchingY=!1),Math.abs(e.center.y-n.center.y)<50&&e.center.x-n.center.x>0&&(this.collisionleft=!0,t.touchingX=!0,t.touchingY=!1),e.center.y-n.center.y<0&&Math.abs(e.center.x-n.center.x)<50&&(this.collisionup=!0,t.touchingX=!1,t.touchingY=!0),Math.abs(e.center.x-n.center.x)<50&&e.center.y-n.center.y>0&&(this.collisiondown=!0,t.touchingX=!0,t.touchingY=!0)},onCollisionExit:function(t){t.touchingX&&t.touchingY?(t.touchingX=null,t.touchingY=null,this.collisiondown=!1):!t.touchingX&&t.touchingY?(t.touchingX=null,t.touchingY=null,this.collisionup=!1):t.touchingX&&!t.touchingY?(t.touchingX=null,t.touchingY=null,this.collisionleft=!1):t.touchingX||t.touchingY||(t.touchingX=null,t.touchingY=null,this.collisionrigh=!1)},shooTank:function(){this.MoveBullet=this.setMove(),Bullet.node.runAction(this.MoveBullet)},start:function(){},connectAndSubscribe:function(){var t=this;(0,e.getStompClient)().then(function(o){t.stompClient=o,(0,e.subscribeTopic)(t.stompClient,"/topic/room-movement-"+t.room,function(o){var n=JSON.parse(o.body);t.loadedPlayers.forEach(function(o){n.id==o.id&&o.id!=t.id&&(console.log("si entra a revisar"),console.log(o),t.moveEnemi(o,n.tecla))})})})},moveEnemi:function(t,o){switch(o){case"a":t.direction="left";break;case"left":t.directionx-50>-451&&(t.directionx-=50,t.direction="left",t.runAction(cc.moveBy(.4,-50,0)));break;case"d":t.direction="right";break;case"right":t.directionx+50<451&&(t.directionx+=50,t.direction="right",t.runAction(cc.moveBy(.4,50,0)));break;case"w":t.direction="up";break;case"up":t.directiony+50<301&&(t.directiony+=50,t.direction="up",t.runAction(cc.moveBy(.4,0,50)));break;case"s":t.direction="down";break;case"down":t.directiony-50>-301&&(t.directiony-=50,t.runAction(cc.moveBy(.4,0,-50)))}},setstart:function(){0==this.pos?(this.node.x,this.directionx=100,this.node.y,this.directiony=-300):1==this.pos?(this.node.x,this.directionx=-100,this.node.y,this.directiony=300):2==this.pos?(this.node.x,this.directionx=450,this.node.y,this.directiony=100):3==this.pos&&(this.node.x,this.directionx=-450,this.node.y,this.directiony=-100)},loadAllPlayers:function(){var t=this,o={onSuccess:function(o){o.data.forEach(function(o){if(o.id!=t.id){var n=cc.instantiate(t.enem);t.loadedPlayers.push(n),n.id=o.id,0==o.pos&&(n.x=100,n.y=-300,n.directionx=100,n.directiony=-300),1==o.pos&&(n.x=-100,n.y=300,n.directionx=-100,n.directiony=300),2==o.pos&&(n.x=450,n.y=100,n.directionx=450,n.directiony=100),3==o.pos&&(n.x=-450,n.y=-100,n.directionx=-450,n.directiony=-100),0,cc.find("Canvas").addChild(n),n.active=!0}else t.pos=o.pos,0==o.pos&&(t.node.x=100,t.node.y=-300),1==o.pos&&(t.node.x=-100,t.node.y=300),2==o.pos&&(t.node.x=450,t.node.y=100),3==o.pos&&(t.node.x=-450,t.node.y=-100)}),t.setstart()},onFailed:function(t){console.log(t)}};(0,i.getRoomPlayers)(t.room,o)}}),cc._RF.pop()},{"./Rest.js":"Rest","./aaaaa":"aaaaa"}]},{},["Bullet","Game","Menu","Rest","Restcontroller","Room","Stomphand","Stomphandler","Walls","aaaaa","pO","tank"]);