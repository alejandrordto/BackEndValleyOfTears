window.__require=function o(t,n,e){function i(s,r){if(!n[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!r&&l)return l(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+s+"'")}}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(o){return i(t[s][1][o]||o)},u,u.exports,o,t,n,e)}return n[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<e.length;s++)i(e[s]);return i}({Bullet:[function(o,t,n){"use strict";cc._RF.push(t,"6dc4akQnvVCdIeaTtY356Tf","Bullet"),cc.Class({extends:cc.Component,properties:{speed:3e3,posX:0,posY:0,direccion:"up"},onCollisionEnter:function(o,t){this.node.destroy()},update:function(o){"down"==this.direccion?(this.node.x+=this.speed*o*Math.cos(90*Math.PI/180),this.node.y+=this.speed*o*Math.sin(270*Math.PI/180)):"up"==this.direccion?(this.node.x+=this.speed*o*Math.cos(270*Math.PI/180),this.node.y+=this.speed*o*Math.sin(90*Math.PI/180)):"left"==this.direccion?(this.node.x+=this.speed*o*Math.cos(180*Math.PI/180),this.node.y+=this.speed*o*Math.sin(0*Math.PI/180)):(this.node.x+=this.speed*o*Math.cos(0*Math.PI/180),this.node.y+=this.speed*o*Math.sin(180*Math.PI/180))}}),cc._RF.pop()},{}],Game:[function(o,t,n){"use strict";cc._RF.push(t,"049cfLKFsxIILQuMd04B47J","Game"),cc.Class({extends:cc.Component,properties:{tank:{default:null,type:cc.Node},channel:null},connectAndSubscribe:function(){console.info("Connecting to WS...");var o=new SockJS("/stompendpoint"),t=Stomp.over(o);t.connect({},function(){self.channel=1,console.log("Connected: "+self.channel),t.subscribe("/topic/newtank."+channel,function(o){JSON.parse(o.body)})}),console.log("Connected: ")},onLoad:function(){this.stompClient=null,this.connectAndSubscribe()}}),cc._RF.pop()},{}],Menu:[function(o,t,n){"use strict";var e;cc._RF.push(t,"86d9c6a06BPCobkgcwgeRLT","Menu");var i=o("./aaaaa"),c=o("./Rest");function s(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}cc.Class({extends:cc.Component,properties:(e={username:null,inputName:{default:null,type:cc.EditBox},inputRoom:{default:null,type:cc.EditBox},sendButton:{default:null,type:cc.Node}},s(e,"username",null),s(e,"room",null),s(e,"id",null),s(e,"xPos",null),s(e,"yPos",null),s(e,"stompClient",null),s(e,"player",{default:null,type:cc.Node}),e),onLoad:function(){cc.game.addPersistRootNode(this.node),this.id=Math.floor(1e7*Math.random()),this.xPos=Math.floor(1e3*Math.random()),this.yPos=Math.floor(600*Math.random())},start:function(){},EditBoxDidEndEditing:function(o){this.username=this.inputName.string},beginOrWait:function(){var o=this,t={onSuccess:function(t){4==t.data.length?o.stompClient.send("/app/start/"+o.room,{},null):cc.director.loadScene("sala",function(){o.node.active=!1})},onFailed:function(o){console.log(o)}};(0,c.getRoomPlayers)(o.room,t)},loadScene:function(){var o=this,t={onSuccess:function(){o.beginOrWait()},onFailed:function(t){alert("Room "+o.room+" game has already started ")}};(0,c.joinRoom)(o.id,o.xPos,o.yPos,o.room,t)},joinThisRoom:function(){var o=this,t={onSuccess:function(){o.loadScene()},onFailed:function(o){console.log(o)}};(0,c.createRoom)(o.room,t)},createOrJoin:function(){var o=this,t={onSuccess:function(t){o.loadScene()},onFailed:function(t){o.joinThisRoom()}};(0,c.getRoomPlayers)(o.room,t)},buttonClicked:function(){var o=this;null==o.username||""==o.username?alert("Please enter a username"):null==o.room||""==o.room?alert("Please enter a room number"):(0,i.getStompClient)().then(function(t){o.stompClient=t,(0,i.subscribeTopic)(o.stompClient,"/topic/room-start-"+o.room,function(t){cc.director.loadScene("game",function(){o.node.active=!1})}),o.createOrJoin()})},setRoom:function(o,t){this.room=t}});cc._RF.pop()},{"./Rest":"Rest","./aaaaa":"aaaaa"}],Restcontroller:[function(o,t,n){"use strict";cc._RF.push(t,"2aa4ezHCtpHrI9Au/WWzDQK","Restcontroller"),Object.defineProperty(n,"__esModule",{value:!0}),n.getRoomPlayers=function(o,t){axios.get("/rooms/"+o+"/players").then(function(o){t.onSuccess(o)}).catch(function(o){t.onFailed(o)})},n.joinRoom=function(o,t,n,e,i,c){axios.put("/rooms/"+i+"/players",{id:o,x:t,y:n,pos:e}).then(function(){c.onSuccess()}).catch(function(o){c.onFailed(o)})},n.createRoom=function(o,t){axios.post("/rooms",{id:o}).then(function(){t.onSuccess()}).catch(function(o){t.onFailed(o)})},n.deleteRoom=function(o,t){axios.delete("/rooms/"+o).then(function(){t.onSuccess()}).catch(function(o){t.onFailed(o)})},cc._RF.pop()},{}],Rest:[function(o,t,n){"use strict";cc._RF.push(t,"d12b5/ARFhLhYYpjru87YS4","Rest"),Object.defineProperty(n,"__esModule",{value:!0}),n.getRoomPlayers=function(o,t){axios.get("/rooms/"+o+"/players").then(function(o){t.onSuccess(o)}).catch(function(o){t.onFailed(o)})},n.joinRoom=function(o,t,n,e,i){axios.put("/rooms/"+e+"/players",{id:o,x:t,y:n}).then(function(){i.onSuccess()}).catch(function(o){i.onFailed(o)})},n.createRoom=function(o,t){axios.post("/rooms",{id:o}).then(function(){t.onSuccess()}).catch(function(o){t.onFailed(o)})},n.deleteRoom=function(o,t){axios.delete("/rooms/"+o).then(function(){t.onSuccess()}).catch(function(o){t.onFailed(o)})},cc._RF.pop()},{}],Room:[function(o,t,n){"use strict";cc._RF.push(t,"bf22aqrH/hFi6iG1Go0J7Nu","Room");var e=o("./aaaaa.js"),i=o("./Rest.js");cc.Class({extends:cc.Component,properties:{item:{default:null,type:cc.Node},label:{default:null,type:cc.Label},content:{default:null,type:cc.Node}},onLoad:function(){this.stompClient=null,this.connectAndSubscribe()},start:function(){this.posY=-51,this.roomNumber=null;var o=this;axios.get("/rooms").then(function(t){var n;for(o.roomNumber=t.data,n=0;n<o.roomNumber;n++)o.showRoomItem(n+1)})},buttonClicked:function(){this.roomNumber<7?this.createRoomItem():alert("Maximun room capacity.")},createRoomItem:function(){var o=this,t={onSuccess:function(){console.log("ROOMMMMMMM--"+(o.roomNumber+1)+"--CREATED SUCCESFULLY"),o.stompClient.send("/topic/menu-newroom",{},JSON.stringify({}))},onFailed:function(t){alert("An error has ocurred creating the room "+(o.roomNumber+1)),console.log(t)}};(0,i.createRoom)(this.roomNumber+1,t)},showRoomItem:function(o){var t=cc.instantiate(this.item);t.y+=this.posY,t.getComponent(cc.Label).string="Room #"+o,t.getChildByName("New Button").getComponent(cc.Button).clickEvents[0].customEventData=o,this.content.addChild(t),this.posY-=51},connectAndSubscribe:function(){var o=this;(0,e.getStompClient)().then(function(t){o.stompClient=t,(0,e.subscribeTopic)(o.stompClient,"/topic/menu-newroom",function(t){o.roomNumber+=1,o.showRoomItem(o.roomNumber)})})}}),cc._RF.pop()},{"./Rest.js":"Rest","./aaaaa.js":"aaaaa"}],Stomphandler:[function(o,t,n){"use strict";cc._RF.push(t,"157f4RWZXJL/rU7UUN+m6oT","Stomphandler"),Object.defineProperty(n,"__esModule",{value:!0}),n.getStompClient=function(){return new Promise(function(o){var t=new SockJS("/stompendpoint"),n=Stomp.over(t);n.connect("yqbofqdf","6CMzc5eiNjOdlv9cP9HpqFmHLK3KxUNS",function(t){o(n)},function(o){console.info("error: "+o)},"yqbofqdf")})},n.subscribeTopic=function(o,t,n){e.push(o.subscribe(t,n))},n.getStompClientsSize=function(){return console.log(e),e.length},n.unsubscribeTopic=function(){};var e=[];cc._RF.pop()},{}],Stomphand:[function(o,t,n){"use strict";cc._RF.push(t,"92a4eHj3ExB3Yb+kVOTQ4+q","Stomphand"),Object.defineProperty(n,"__esModule",{value:!0}),n.getStompClient=function(){return new Promise(function(o){var t=new SockJS("/stompendpoint"),n=Stomp.over(t);n.connect("yqbofqdf","6CMzc5eiNjOdlv9cP9HpqFmHLK3KxUNS",function(t){o(n)},function(o){console.info("error: "+o)},"yqbofqdf")})},n.subscribeTopic=function(o,t,n){e.push(o.subscribe(t,n))},n.getStompClientsSize=function(){return console.log(e),e.length},n.unsubscribeTopic=function(){};var e=[];cc._RF.pop()},{}],Walls:[function(o,t,n){"use strict";cc._RF.push(t,"68129qznU5I+bpPsoU4OySA","Walls"),cc.Class({extends:cc.Component,properties:{life:0},onCollisionEnter:function(o,t){"bullet"==o.node.name&&-1!=this.life&&(this.life-=1)},onCollisionExit:function(o){},golpe:function(){0==this.life&&this.node.destroy()},start:function(){},update:function(o){this.golpe()}}),cc._RF.pop()},{}],aaaaa:[function(o,t,n){"use strict";cc._RF.push(t,"05e60rJyDFEk6BPkM/JK1U/","aaaaa"),Object.defineProperty(n,"__esModule",{value:!0}),n.getStompClient=function(){return new Promise(function(o){var t=new SockJS("/stompendpoint"),n=Stomp.over(t);n.connect({},function(t){o(n)},function(o){console.info("error: "+o)})})},n.subscribeTopic=function(o,t,n){e.push(o.subscribe(t,n))},n.getStompClientsSize=function(){return console.log(e),e.length},n.unsubscribeTopic=function(){};var e=[];cc._RF.pop()},{}],pO:[function(o,t,n){"use strict";cc._RF.push(t,"bdded87CDRBx5CxG9lDLONB","pO"),cc.Class({extends:cc.Component,properties:{id:null}}),cc._RF.pop()},{}],tank:[function(o,t,n){"use strict";cc._RF.push(t,"4420dBIaPxE6rlCexOCy3f1","tank");var e=o("./aaaaa"),i=o("./Rest.js");cc.Class({extends:cc.Component,properties:{pos:null,id:null,stompClient:null,directionx:0,directiony:0,direction:"up",colicion:!1,collisionleft:!1,collisionrigh:!1,collisionup:!1,collisiondown:!1,bullet:{default:null,type:cc.Node},loadedPlayers:{default:[],type:[cc.Node]},player:{default:null,type:cc.Node},enem:{default:null,type:cc.Node}},setRotate:function(o){var t;return"up"==this.direction?"left"==o?(t=cc.rotateBy(0,90),this.rotationx=180,this.rotationy=0):"down"==o?(t=cc.rotateBy(0,180),this.rotationx=-90,this.rotationy=0):(t=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270):"down"==this.direction?"right"==o?(t=cc.rotateBy(0,90),this.rotationx=0,this.rotationy=0):"up"==o?(t=cc.rotateBy(0,180),this.rotationx=0,this.rotationy=-90):(t=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270):"left"==this.direction?"down"==o?(t=cc.rotateBy(0,90),this.rotationx=0,this.rotationy=90):"right"==o?(t=cc.rotateBy(0,180),this.rotationx=0,this.rotationy=180):(t=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270):"up"==o?(t=cc.rotateBy(0,90),this.rotationx=0,this.rotationy=90):"left"==o?(t=cc.rotateBy(0,180),this.rotationx=0,this.rotationy=180):(t=cc.rotateBy(0,270),this.rotationx=0,this.rotationy=270),t},onKeyEvent:function(o){var t=this.direction,n=!0;switch(o.keyCode){case cc.macro.KEY.a:this.direction="left";break;case cc.macro.KEY.left:this.directionx-50>-451&&!this.collisionleft&&(this.directionx-=50,this.direction="left",this.node.runAction(cc.moveBy(.4,-50,0)));break;case cc.macro.KEY.d:this.direction="right";break;case cc.macro.KEY.right:this.directionx+50<451&&!this.collisionrigh&&(this.directionx+=50,this.direction="right",this.node.runAction(cc.moveBy(.4,50,0)));break;case cc.macro.KEY.w:this.direction="up";break;case cc.macro.KEY.up:this.directiony+50<301&&!this.collisionup&&(this.directiony+=50,this.direction="up",this.node.runAction(cc.moveBy(.4,0,50)));break;case cc.macro.KEY.s:this.direction="down";break;case cc.macro.KEY.down:this.directiony-50>-301&&!this.collisiondown&&(this.directiony-=50,this.rota="down",this.node.runAction(cc.moveBy(.4,0,-50)));break;case cc.macro.KEY.space:var e=cc.instantiate(this.bullet);e.getComponent("Bullet").direccion=this.direction,e.x=this.node.position.x,e.y=this.node.position.y,cc.find("Canvas").addChild(e),e.active=!0;break;default:n=!1}t!=this.direction&&n&&(this.Dir=this.setRotate(t),this.node.runAction(this.setRotate(t))),this.stompClient.send("/app/room-movement",{},JSON.stringify({id:this.id,positiony:this.node.y,positionx:this.node.x,rotation:this.direction,pos:this.pos}))},onLoad:function(){this.room=cc.find("form").getComponent("Menu").room,this.username=cc.find("form").getComponent("Menu").username,this.id=cc.find("form").getComponent("Menu").id,this.players=null,this.connectAndSubscribe(),cc.audioEngine.stopAll(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyEvent,this),cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1,this.rotationx=0,this.rotationy=90,this.loadAllPlayers()},onEnable:function(){cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1},onDisable:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getCollisionManager().enabledDebugDraw=!1},onCollisionEnter:function(o,t){var n=o.world.aabb,e=(o.world.preAabb.clone(),t.world.aabb);t.world.preAabb.clone();e.center.x-n.center.x<0&&Math.abs(e.center.y-n.center.y)<50&&(this.collisionrigh=!0,o.touchingX=!1,o.touchingY=!1),Math.abs(e.center.y-n.center.y)<50&&e.center.x-n.center.x>0&&(this.collisionleft=!0,o.touchingX=!0,o.touchingY=!1),e.center.y-n.center.y<0&&Math.abs(e.center.x-n.center.x)<50&&(this.collisionup=!0,o.touchingX=!1,o.touchingY=!0),Math.abs(e.center.x-n.center.x)<50&&e.center.y-n.center.y>0&&(this.collisiondown=!0,o.touchingX=!0,o.touchingY=!0)},onCollisionExit:function(o){o.touchingX&&o.touchingY?(o.touchingX=null,o.touchingY=null,this.collisiondown=!1):!o.touchingX&&o.touchingY?(o.touchingX=null,o.touchingY=null,this.collisionup=!1):o.touchingX&&!o.touchingY?(o.touchingX=null,o.touchingY=null,this.collisionleft=!1):o.touchingX||o.touchingY||(o.touchingX=null,o.touchingY=null,this.collisionrigh=!1)},shooTank:function(){this.MoveBullet=this.setMove(),Bullet.node.runAction(this.MoveBullet)},start:function(){},connectAndSubscribe:function(){var o=this;(0,e.getStompClient)().then(function(t){o.stompClient=t,(0,e.subscribeTopic)(o.stompClient,"/topic/room-movement",function(t){var n=JSON.parse(t.body);o.loadedPlayers.forEach(function(t){n.id==t.id&&t.id!=o.id&&(console.log("si entra a revisar"),console.log(n.positionx),console.log(n),t.x=n.positionx,t.y=n.positiony,t.direction=n.rotation)})})})},setstart:function(){0==this.pos?(this.node.x,this.directionx=100,this.node.y,this.directiony=-300):1==this.pos?(this.node.x,this.directionx=-100,this.node.y,this.directiony=300):2==this.pos?(this.node.x,this.directionx=450,this.node.y,this.directiony=100):3==this.pos&&(this.node.x,this.directionx=-450,this.node.y,this.directiony=-100)},loadAllPlayers:function(){var o=this,t={onSuccess:function(t){t.data.forEach(function(t){if(t.id!=o.id){var n=cc.instantiate(o.enem);o.loadedPlayers.push(n),n.id=t.id,0==t.pos&&(n.x=100,n.y=-300),1==t.pos&&(n.x=-100,n.y=300),2==t.pos&&(n.x=450,n.y=100),3==t.pos&&(n.x=-450,n.y=-100),0,cc.find("Canvas").addChild(n),n.active=!0}else o.pos=t.pos,0==t.pos&&(o.node.x=100,o.node.y=-300),1==t.pos&&(o.node.x=-100,o.node.y=300),2==t.pos&&(o.node.x=450,o.node.y=100),3==t.pos&&(o.node.x=-450,o.node.y=-100)}),o.setstart()},onFailed:function(o){console.log(o)}};(0,i.getRoomPlayers)(o.room,t)}}),cc._RF.pop()},{"./Rest.js":"Rest","./aaaaa":"aaaaa"}]},{},["Bullet","Game","Menu","Rest","Restcontroller","Room","Stomphand","Stomphandler","Walls","aaaaa","pO","tank"]);